# 브라우저 동작 방법



## 브라우저 주요 기능

- 사용자가 선택한 자원을 서버에 요청, 브라우저에 표시

- 자원은 html 문서, pdf, image 등 다양한 형태

- 자원의 주소는 URI에 의해 정해진다

  > 참고 : [URI & URL](https://github.com/souvenir718/TIL/blob/master/JS/JS%20-%20URL%20%26%20URI.md)



  브라우저는 html과 css 명세에 따라 html 파일을 해석해서 표시한다. 이 **명세**는 웹 표준화 기구인 **W3C**에서 정해진다.

  브라우저가 가진 인터페이스

- URI 입력하는 주소 표시줄
- 이전 버튼, 다음 버튼
- 북마크(즐겨찾기)
- 새로고침 버튼
- 홈 버튼



## 브라우저 기본 구조

<img src="https://camo.githubusercontent.com/0e3ac4e617b8eda5046f592c74a1f7e4cbfb82a5c6abe8d5699020002c1227b6/68747470733a2f2f64322e6e617665722e636f6d2f636f6e74656e742f696d616765732f323031352f30362f68656c6c6f776f726c642d35393336312d312e706e67" style="zoom:70%;" /> 



### 사용자 인터페이스

  주소 표시줄, 이전 / 다음 버튼, 북마크 등 사용자가 활용하는 서비스(요청한 페이지를 보여주는 창을 제외한 나머지 부분)



### 브라우저 엔진

  사용자 인터페이스와 렌더링 엔진 사이의 동작 제어



### 렌더링 엔진

  요청한 컨텐츠 표시 ( html 요청 => html, css 파싱해서 화면에 표시 )



### 통신

  http 요청과 같은 네트워크 호출에 사용



### UI 백엔드

  플랫폼에서 명시하지 않은 일반적 인터페이스. 콤보박스 창 같은 기본적 장치를 그린다.



### 자바스크립트 해석기

  자바스크립트 코드를 해석하고 실행한다.



### 자료 저장소

  쿠키 등 모든 종류의 자원을 하드 디스크에 저장하는 계층



### 렌터링이란?

  렌터링 엔진은 요청받은 내용을 브라우저 화면에 표시해준다. 기본적으로 `html`, `xml` 문서와 이미지를 표시할 수 있다. 추가로 플러그인이나 브라우저 확장 기능으로 `pdf` 등 다른 유형도 표시가 가능하다.



#### 렌더링 엔진 종류

- 크롬, 사파리 : 웹킷(Webkit) 엔진을 사용한다.

- 파이어폭스 : 게코(Gecko) 엔진 사용

  > **웹킷(Webkit)** : 최초 리눅스 플랫폼에 동작하기 위한 오픈소스 엔진



#### 렌더링 동작 과정

<img src="https://camo.githubusercontent.com/b7b2e4f87463a5508b6cc434e99d58c48b5b8ba1aa8a4d917d9d240fd94aebf1/68747470733a2f2f64322e6e617665722e636f6d2f636f6e74656e742f696d616765732f323031352f30362f68656c6c6f776f726c642d35393336312d322e706e67" style="zoom:80%;" /> 

1. `html` 문서를 파싱한다.
2. 컨텐츠 트리 내부에서 태그를 모두 `DOM` 노드로 변환한다.
3. 외부 `css` 파일과 함께 포함된 스타일 요소를 파싱한다.
4. 스타일 정보와 `html` 표시 규칙은 **렌더 트리**라고 불리는 트리를 생성한다.
5. **렌더 트리**는 정해진 순서대로 화면에 표시되는데, 생성과정이 끝났을 때 배치가 진행되면서 노드가 화면의 정확한 위치에 표시되는 것을 의미한다.
6. UI 백엔드에서 **렌더 트리**의 각 노드를 가로지으며 형상을 만드는 그리기 과정이 진행된다.
7. 렌더링 엔진은 좀더 빠르게 사용자에게 제공하기 위해 모든 `html`을 파싱할 때까지 기다리지 않고 배치와 그리기 과정을 시작하낟.



### DOM이란?

DOM(Document Object Model) : 문서 객체 모델

  웹페이지의 소스 중 `<html>` 과 `<body>` 와 같은 태그들이 존재한다. 이를 **Javascript**가 활용할 수 있는 객체로 만들면 **문서 객체**가 된다. 모델은 말 그대로 모듈화로 만들었다거나 객체를 인식한다라고 해석하면 된다.

  즉, **DOM**은 웹 브라우저가 `html` 페이지를 인식하는 방식을 말한다.(트리 구조)



#### 웹킷 동작 구조

<img src="https://camo.githubusercontent.com/fa4fdb9b5d45fec78ad6717a4f3d0099d8fe46287e2aa38a7b0500c77a48211b/68747470733a2f2f64322e6e617665722e636f6d2f636f6e74656e742f696d616765732f323031352f30362f68656c6c6f776f726c642d35393336312d332e706e67" style="zoom:80%;" /> 

**어태치먼트** : 웹킷이 렌더 트리를 생성하기 위해 DOM 노드와 스타일 정보를 연결하는 과정



## 파싱과 DOM 트리 구축



### 파싱(parsing)

  문서 파싱은브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것이다. 문서를 가지고 **어휘 분석**과 **구문 분석** 과정을 거쳐 파싱 트리를 구축한다. 어휘 분석기를 통해 언어의 구문 규칙에 따라 문서 구조를 분석한다.  이 과정에서 구문 규칙과 일치하는지 비교하고 일치하는 노드만 파싱 트리에 추가한다.

결국 이 파싱과정을 거치면서 서버로부터 받은 문서를 브라우저가 이해하고 쉽게 사용할 수 있는 DOM 트리구조로 변환시켜주는 것이다.